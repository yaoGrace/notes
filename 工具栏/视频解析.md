####  视频解析类功能介绍
> 此类用于解析视频，目前可解析：B站视频( 仅限up主上传的视频 )  
> 注意：有些视频或者图片因三方开启防盗链，不携带referer后 可以显示
```
<meta name="referrer" content="never">
```

#### 部署说明
>将 videoPre.php 文件直接部署到 phpGrace/tools/ 文件夹下
```php
//创建实例  
$videoPre = new phpGrace\tools\videoPre(); 

// 用统一的接口来处理，不需要记住那么多函数 。返回解析结果
return $videoPre->jiexi(参数1，参数2);

参数1： 视频类型，固定字符 
参数2： 视频短链接字符串
```
> 对参数1 视频类型的说明 

| 参数1 类型说明   | 对应参数 （string）   |
| ----------- | ----------- |
| 解析B站单视频 |  b |
| 解析B站视频集 | b_all |
| 解析抖音视频 | dy |
| 解析西瓜视频 | xg | 
| 超星网盘 提取视频短链接，通过视频图标链接提取| cxPan_GetVideoSortLink_ByVideoImgLink|
| 超星小组云盘 ，通过目录链接 提取该目录下所有视频的短链接 | cxGroup_GetVideoList_ByListLink |
| 解析超星网盘单个视频和解析超星小组云盘的单个视频 都用此参数 | cx |
| 解析streamja视频床   | st |



 > 参数1 哪些需要设置Cookie  （ **B站和超星 需要设置Cookie, 在框架Config.php 里面填写，不然会报错** ）

```php
 打开 config.php 文件
 添加：
    // 视频解析用到的Cookie
    'cookie'            =>array(
        'set_B_Cookie'  =>'_uuid=xxxxxx',  #B站的Cookie
        'set_ChaoXing_Cookie'=>'xxxxx ',   #超星的Cookie
    )

```

---

#### 解析：B站UP主视频(单个视频)
> 官网： https://www.bilibili.com/      
> 解析B站视频，注意：只能解析UP主上传的免费视频，影视之类，收费的 的不能解析

```php
/*
 * URL 说明
 * https://www.bilibili.com/video/BV1u4411u7PL?p=8 原视频网址
 * 注意：B站分为 单集视频和集合视频
 * 单集视频： BV1u4411u7PL
 * 分集视频： BV1u4411u7PL-8 表示第8集分集
*/  
# 第一步：填写你的B站cookie(不填解析不到1080P以上) 格式为_uuid=XXXXX  
  Config.php 里面填写Cookie  位置： set_B_Cookie

# 第二步：设置需要提取视频直链的B站网址关键字段
$videoPre = new phpGrace\tools\videoPre(); 
$url = 'BV1u4411u7PL';  或者 $url = 'BV1u4411u7PL-8'; 
# 第三步： 执行解析 并返回json加密后的结果
$res =  $videoPre->jiexi('b',$url); 
   

#返回结果json格式： 
{
    "code": 1,
    "msg": "解析成功!",
    "data": {
        "title": "标题",
        "video_url": "视频直链",
        "imgurl": "封面图片"
    }
}
```
#### 提取：B站UP主视频(批量视频)
```php
# 此功能提取该链接下的所有分集视频 (没有分集的则提取本身的视频)
/*
 * 参数URL 说明
 * https://www.bilibili.com/video/BV1u4411u7PL?p=8 原视频网址
 * 注意：B站分为 单集视频和集合视频
 * 视频链接： BV1u4411u7PL 
*/
# 第一步：填写你的B站cookie(不填解析不到1080P以上) 格式为_uuid=XXXXX
 Config.php 里面填写Cookie  位置： set_B_Cookie 
# 第二步：设置需要提取视频直链的B站网址关键字段
$videoPre = new phpGrace\tools\videoPre(); 
$url = 'BV1u4411u7PL';  
# 第三步： 执行解析 并返回json加密后的结果
$res =  $videoPre->jiexi('b_all',$url); 

# 返回结果json 格式:
{
    "code": 1,    // 此处为解析结果代码  0表示失败，1表示成功 
    "msg": "解析结果！",
    "title": "视频集合或者视频的总标题",
    "imgurl": "视频的封面图片链接",
    "data": {
        "0": {
            "title": "分集的 -- 标题",
            "video_url": "分集的 -- 视频直链"
        },
        "1": {
            "title": "分集的 -- 标题",
            "video_url": "分集的 -- 视频直链"
        },
        .................. 
    }
}
```
#### 解析：抖音无水印视频
> 官网： https://www.douyin.com/      
> 解析抖音，通过分享的抖音短网址提取视频

```php 
/**
 * url 参数说明   
 * https://v.douyin.com/6jokoWg/  此链接是通过 PC端或者手机端 分享链接 得到的  
 */
$videoPre = new phpGrace\tools\videoPre(); 
$url = '6jokoWg'; 
$res =  $videoPre->jiexi('dy',$url); 

# 返回结果json格式:
{
    "code": 200,
    "msg": "解析成功",
    "data": {
        "title": "我是视频标题",
        "imgurl": "我是封面图片",
        "video_url": "我是视频直链"
    }
}
```

#### 解析：西瓜视频
> 官网： https://www.ixigua.com/   
> 注意：只能解析用户自己上传的视频， 解析电影之类没尝试

```php 
# URL 部分 ：https://www.ixigua.com/7108964496789471751
$videoPre = new phpGrace\tools\videoPre(); 
$url = '7108964496789471751';
$res =  $videoPre->jiexi('xg',$url); 

# 返回结果json格式:
{
    "code": 200,
    "msg": "解析成功",
    "data": {
        "title": "我是标题",
        "imgurl": "我是封面图片",
        "video_url": "我是视频直链"
    }
}
```

#### 提取：通过超星视频封面提取视频短链
> 官网： http://pan-yz.chaoxing.com   
> 超星个人网盘内的文件删除后依然可以调用，这样达到无限空间目的

```php
第一步: 手动复制超星网盘内的视频封面的真实链接地址 
        比如 https://p2.ananas.chaoxing.com/video/61/88/8f/1a41b66546253181a8acb0b3cc41dc21/snapshot.jpg
第二步: 填写参数 
        $type = 'cxPan_GetVideoSortLink_ByVideoImgLink';
        $imgurl = 'https://p2.ananas.chaoxing.com/video/61/88/8f/1a41b66546253181a8acb0b3cc41dc21/snapshot.jpg'; 
        $videoPre = new phpGrace\tools\videoPre(); 
        $res =  $videoPre->jiexi($type,$imgurl); 
# 返回的是String格式字符串视频短链( 后期如果需要解析视频，也是按照这种短链格式解析 )：
 即：   '61/88/8f/1a41b66546253181a8acb0b3cc41dc21';

``` 

#### 提取：小组视频目录下所有视频列表

> 超星小组官网： http://groupweb.chaoxing.com/pc/circle/circleIndex    
> 在 小组列表 里面点击 对应的小组名称 ， 进入小组，点击 小组云盘 在里面上传视频 之类，无限空间

```php
第一步：手动获取视频目录链接
例如  
$listMenuUrl = 'http://groupweb.chaoxing.com/pc/resource/getResourceList?bbsid=2420cabd-11c8-4ff8-9a91-808ba442e09d&folderId=97455&recType=2';

$type = 'cxGroup_GetVideoList_ByListLink'; 
$videoPre = new phpGrace\tools\videoPre(); 
$res = $videoPre->jiexi($type,$listMenuUrl);


# 返回结果为 数组
Array
(
    [0] => Array
        (
            [name] => 046 - 1 - 整体介绍【迈思PHP框架系统】
            [fileid] => 5f/ad/9b/4015b89ce5fae75f6324e761141a5ea1
        ) 
    [1] => Array
        (
            [name] => 045 - 2 - 基础配置【迈思PHP框架系统】
            [fileid] => 77/01/08/0bfb2a13534f657b64ed44a0e978abcd
        ) 
    [2] => Array
        (
            [name] => 044 - 3 - 功能设置【迈思PHP框架系统】
            [fileid] => 3c/56/17/933493b4c9517cd4465dd8ad4e12cfd5
        ) 
)
 ```
#### 解析：超星网盘视频720P 
> 官网： http://pan-yz.chaoxing.com   
> 超星个人网盘内的文件删除后依然可以调用，这样达到无限空间目的

```php 
解析前台传过来的视频短链，格式为：$videoUrl ='61/88/8f/1a41b66546253181a8acb0b3cc41dc21'; 这种

$videoUrl ='61/88/8f/1a41b66546253181a8acb0b3cc41dc21'; 
$type = 'cx';
$videoPre = new phpGrace\tools\videoPre(); 
$res = $videoPre->jiexi($type,$videoUrl);

#返回结果JSON格式

{
    "code": 1,
    "msg": "解析成功",
    "data": {
        "video_url": "视频直链"
    }
}

```



####  解析： streamja视频床

> 官网：https://streamja.com/  
> 特点：单个视频限制50m，免审，不卡，跳转，永久，免登

```php
播放链接：https://streamja.com/OGlrj
$type = 'st';
$url = 'OGlrj';
$videoPre = new phpGrace\tools\videoPre(); 
$res = $videoPre->jiexi($type,$url);

#返回结果 json格式 

#解析正确，格式例如：
{
    "code": "1",
    "msg": "解析成功",
    "data": {
        "video_url": "视频直链"
    }
}

# 解析错误 ，返回json格式例如：
{
    "code": "0",
    "msg": "解析失败" 
}
```